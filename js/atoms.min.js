var numAtoms=25,maxVelocity=.3,radius=8,canvas,ctx,atoms=[],collidedIndices,lineCoordinates,fps,fpsInterval,then,now,elapsed;requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||setTimeout;
function init(){var a=canvas.width,b=canvas.height,c;for(c=0;c<numAtoms;c++)atoms[c]={x:Math.floor(Math.random()*(a-2*radius)+radius),y:Math.floor(Math.random()*(b-2*radius)+radius),dx:2*Math.random()*maxVelocity-maxVelocity,dy:2*Math.random()*maxVelocity-maxVelocity,collided:!1};fps=24;fpsInterval=1E3/fps;startTime=then=Date.now()}function start(){now=Date.now();elapsed=now-then;elapsed>fpsInterval&&(then=now-elapsed%fpsInterval,update(),draw());requestAnimationFrame(start)}
function update(){var a,b;for(a=0;a<atoms.length;a++){atoms[a].x+=atoms[a].dx;atoms[a].y+=atoms[a].dy;if(atoms[a].x<=radius||atoms[a].x>=width-radius)atoms[a].dx=-atoms[a].dx,atoms[a].x+=atoms[a].dx;if(atoms[a].y<=radius||atoms[a].y>=height-radius)atoms[a].dy=-atoms[a].dy,atoms[a].y+=atoms[a].dy}collidedIndices=new Set;lineCoordinates=new Set;for(a=0;a<atoms.length;a++)for(b=0;b<atoms.length;b++)a!=b&&isCollided(atoms[a],atoms[b])&&(collidedIndices.add(a),collidedIndices.add(b),lineCoordinates.add({x1:atoms[a].x,
y1:atoms[a].y,x2:atoms[b].x,y2:atoms[b].y}))}function sq(a){return a*a}function isCollided(a,b){return sq(b.x-a.x)+sq(b.y-a.y)<=30*sq(radius)?!0:!1}
function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.lineWidth=1;ctx.strokeStyle="rgba(50,50,50,0.3)";lineCoordinates.forEach(function(a){ctx.beginPath();ctx.moveTo(a.x1,a.y1);ctx.lineTo(a.x2,a.y2);ctx.stroke()});var a;ctx.fillStyle="rgba(230, 230, 230, 1)";for(a=0;a<atoms.length;a++)collidedIndices.has(a)||drawCircle(atoms[a].x,atoms[a].y,radius);ctx.fillStyle="rgba(30, 155, 230, 1)";collidedIndices.forEach(function(a){drawCircle(atoms[a].x,atoms[a].y,radius)})}
function drawCircle(a,b,c){ctx.beginPath();ctx.arc(a,b,c,0,2*Math.PI,!0);ctx.closePath();ctx.fill()}window.onload=function(){canvas=document.getElementById("animation");ctx=canvas.getContext("2d");ctx.canvas.width=window.innerWidth-10;ctx.canvas.height=100;width=ctx.canvas.width-10;height=ctx.canvas.height-10;init();start()};
