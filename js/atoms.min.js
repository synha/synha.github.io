var numAtoms=25;var maxVelocity=0.3;var radius=8;var canvas;var ctx;var atoms=[];var collidedIndices;var lineCoordinates;var fps,fpsInterval,then,now,elapsed;requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||setTimeout;function init(){var c=canvas.width;var a=canvas.height;var b;for(b=0;b<numAtoms;b++){atoms[b]={x:Math.floor(Math.random()*(c-2*radius)+radius),y:Math.floor(Math.random()*(a-2*radius)+radius),dx:Math.random()*2*maxVelocity-maxVelocity,dy:Math.random()*2*maxVelocity-maxVelocity,collided:false}}fps=24;fpsInterval=1000/fps;then=Date.now();startTime=then}function start(){now=Date.now();elapsed=now-then;if(elapsed>fpsInterval){then=now-(elapsed%fpsInterval);update();draw()}requestAnimationFrame(start)}function update(){var b,a;for(b=0;b<atoms.length;b++){atoms[b].x+=atoms[b].dx;atoms[b].y+=atoms[b].dy;if(atoms[b].x<=radius||atoms[b].x>=width-radius){atoms[b].dx=-atoms[b].dx;atoms[b].x+=atoms[b].dx}if(atoms[b].y<=radius||atoms[b].y>=height-radius){atoms[b].dy=-atoms[b].dy;atoms[b].y+=atoms[b].dy}}collidedIndices=new Set();lineCoordinates=new Set();for(b=0;b<atoms.length;b++){for(a=0;a<atoms.length;a++){if(b==a){continue}if(isCollided(atoms[b],atoms[a])){collidedIndices.add(b);collidedIndices.add(a);lineCoordinates.add({x1:atoms[b].x,y1:atoms[b].y,x2:atoms[a].x,y2:atoms[a].y})}}}}function sq(a){return a*a}function isCollided(b,a){var c=30;if(sq(a.x-b.x)+sq(a.y-b.y)<=c*sq(radius)){return true}else{return false}}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.lineWidth=1;ctx.strokeStyle="rgba(50,50,50,0.3)";lineCoordinates.forEach(function(b){ctx.beginPath();ctx.moveTo(b.x1,b.y1);ctx.lineTo(b.x2,b.y2);ctx.stroke()});var a;ctx.fillStyle="rgba(230, 230, 230, 1)";for(a=0;a<atoms.length;a++){if(collidedIndices.has(a)){continue}drawCircle(atoms[a].x,atoms[a].y,radius)}ctx.fillStyle="rgba(30, 155, 230, 1)";collidedIndices.forEach(function(b){drawCircle(atoms[b].x,atoms[b].y,radius)})}function drawCircle(a,c,b){ctx.beginPath();ctx.arc(a,c,b,0,Math.PI*2,true);ctx.closePath();ctx.fill()}window.onload=function(){canvas=document.getElementById("animation");ctx=canvas.getContext("2d");ctx.canvas.width=window.innerWidth-10;ctx.canvas.height=100;width=ctx.canvas.width-10;height=ctx.canvas.height-10;init();start()};